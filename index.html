<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema Cobran√ßa - MedCof</title>

    <link rel="icon" type="image/png" href="icon.png">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/pt.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="login-screen">
        <div class="login-box">
            <img src="logo.png" alt="MedCof Logo" class="login-logo">
            <h2>Acesso Restrito</h2>
            
            <p style="color: #666; margin-bottom: 20px;">Utilize sua conta corporativa para acessar o sistema.</p>

            <button id="google-btn" onclick="loginWithGoogle()" type="button" class="google-btn">
                <div class="btn-content">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg" style="width: 20px; margin-right: 12px;">
                    ENTRAR COM GOOGLE
                </div>
                <div class="btn-loader hidden">
                    <i class="fas fa-circle-notch fa-spin"></i>
                </div>
            </button>

            <p id="login-message" style="margin-top: 15px;"></p>
        </div>
    </div>

    <div id="app-content" style="display: none;">
        
        <div id="sidebar-menu">
            <div class="sidebar-header">
                <img src="logo.png" alt="Logo da Empresa" id="sidebar-logo">
            </div>  
            
            <div id="nav-menu" class="sidebar-content">
                <button id="btn-home" class="nav-tab" onclick="window.showTab('tab-home', this)">
                    <i class="fas fa-house"></i> In√≠cio
                </button>

                <button id="btn-nav-usuarios" class="nav-tab admin-only" style="display: none;" 
                        onclick="showTab('tab-usuarios', this); if(window.loadUserListData) window.loadUserListData()">
                    <i class="fas fa-user-shield"></i> Gerenciar Equipe
                </button>

                <div class="sector-group" data-sector="cobranca">
                    <button class="nav-tab sector-btn" data-sector="cobranca" onclick="showTab('tab-escala', this)">
                        <i class="fas fa-calendar-days"></i> Escala Mensal
                    </button>
                </div>

                <button id="btn-dashboard" class="nav-tab admin-only" onclick="window.showTab('tab-dashboard', this)">
                    <i class="fas fa-chart-line"></i> Dashboard Cobran√ßa
                </button>
                
                <button id="btn-dash-juridico" class="nav-tab admin-only" onclick="window.showTab('tab-dash-juridico', this)">
                    <i class="fas fa-scale-balanced"></i> Dashboard Jur√≠dica
                </button>

                <div class="menu-group sector-group" data-sector="cobranca">
                    <div class="sector-title">COBRAN√áA</div>
                    <button class="menu-header" onclick="window.toggleMenu('menu-agendamentos')">
                        <i class="fas fa-calendar-check"></i> Agendamentos <span class="arrow">‚ñº</span>
                    </button>
                    <div id="menu-agendamentos" class="menu-content">
                        <button class="nav-tab sector-btn" data-sector="cobranca" onclick="window.showTab('tab-agendamento', this)">Novo Agendamento</button>
                        <button class="nav-tab sector-btn" data-sector="cobranca" onclick="window.showTab('tab-calendario', this)">Calend√°rio</button>
                        <button id="btn-hist-cobranca" class="nav-tab sector-btn" data-sector="cobranca" onclick="window.showTab('tab-lista-cobranca', this)">Hist√≥rico</button>
                    </div>
                </div>

                <div class="menu-group sector-group" data-sector="cobranca">
                    <button class="menu-header" onclick="window.toggleMenu('menu-ligacoes')">
                        <i class="fas fa-phone-volume"></i> Liga√ß√µes <span class="arrow">‚ñº</span>
                    </button>
                    <div id="menu-ligacoes" class="menu-content">
                        <button class="nav-tab sector-btn" data-sector="cobranca" onclick="window.showTab('tab-cobranca', this)">3¬™ Cobran√ßa</button>
                    </div>
                </div>

                <div class="menu-group sector-group" data-sector="juridico">
                    <div class="sector-title">JUR√çDICO</div>
                    <button class="menu-header" onclick="window.toggleMenu('menu-juridico-ag')">
                        <i class="fas fa-file-contract"></i> Agendamentos <span class="arrow">‚ñº</span>
                    </button>
                    <div id="menu-juridico-ag" class="menu-content">
                        <button class="nav-tab sector-btn" data-sector="juridico" onclick="window.showTab('tab-juridico-novo', this)">Novo Agendamento</button>
                        <button class="nav-tab sector-btn" data-sector="juridico" onclick="window.showTab('tab-juridico-calendario', this)">Calend√°rio</button>
                        <button id="btn-hist-juridico" class="nav-tab sector-btn" data-sector="juridico" onclick="window.showTab('tab-lista-juridico', this)">Hist√≥rico Jur.</button>                    
                    </div>
                </div>

                <div class="menu-group sector-group" data-sector="juridico">
                    <button class="menu-header" onclick="window.toggleMenu('menu-juridico-lig')">
                        <i class="fas fa-headset"></i> Liga√ß√µes <span class="arrow">‚ñº</span>
                    </button>
                    <div id="menu-juridico-lig" class="menu-content">
                        <button id="btn-juridico-ligacoes" class="nav-tab sector-btn" data-sector="juridico" onclick="window.showTab('tab-juridico-ligacoes', this)">1¬∞ Jur√≠dica</button>
                    </div>
                </div>

                <div class="menu-group sector-group" data-sector="disparos">
                    <div class="sector-title">DISPAROS</div>
                    <button class="menu-header" onclick="window.toggleMenu('menu-disparos')">
                        <i class="fas fa-paper-plane"></i> Gest√£o de Envios <span class="arrow">‚ñº</span>
                    </button>
                    <div id="menu-disparos" class="menu-content">
                        <button class="nav-tab sector-btn" data-sector="disparos" onclick="window.showTab('tab-disparos-registros', this)">
                            Registros Di√°rios
                        </button>
                    </div>
                </div>
            </div>

            <div class="sidebar-footer">  
                <button class="nav-tab logout-btn" onclick="window.logoutSystem()">
                    <i class="fas fa-right-from-bracket"></i> Sair
                </button>
            </div>
        </div>
        
        <div id="main-content">
            
            <div id="tab-home" class="tab-content">
                <div class="home-header-premium">
                    <div class="welcome-container">
                        <div class="welcome-text-group">
                            <h1>Ol√°, <span id="home-user-name" class="name-highlight">Jo√£o</span>! <span class="wave-emoji">üëã</span></h1>
                            <p>Bem-vindo ao Sistema de Cobran√ßa da <strong>MedCof</strong>. O que vamos fazer hoje?</p>
                        </div>
                    </div>
                    
                    <div class="header-clock-box">
                        <div class="clock-item">
                            <i class="fas fa-clock"></i>
                            <span id="live-clock">16:40:48</span>
                        </div>
                        <div class="clock-item">
                            <i class="fas fa-calendar-day"></i>
                            <span id="live-date">02 de janeiro de 2026</span>
                        </div>
                    </div>
                </div>

                <div class="home-cards-container">
                    <div class="home-sector-section sector-group" data-sector="cobranca">
                        <h3 class="home-sector-title">Cobran√ßa</h3>
                        <div class="home-cards-grid">
                            <div class="home-card" onclick="window.showTab('tab-agendamento', document.querySelector('[onclick*=\'tab-agendamento\']'))">
                                <div class="icon-container"><i class="fas fa-calendar-check"></i></div>
                                <h3>Novo Agendamento</h3>
                                <p>Agendar link de pagamento</p>
                            </div>
                            
                            <div class="home-card" onclick="document.getElementById('btn-hist-cobranca').click()">
                                <div class="icon-container"><i class="fas fa-folder-open"></i></div>
                                <h3>Hist√≥rico</h3>
                                <p>Consultar agendamentos</p>
                            </div>

                            <div class="home-card" onclick="window.showTab('tab-cobranca', document.querySelector('[onclick*=\'tab-cobranca\']'))">
                                <div class="icon-container"><i class="fas fa-phone-volume"></i></div>
                                <h3>3¬™ Cobran√ßa</h3>
                                <p>Gest√£o de inadimpl√™ncia</p>
                            </div>

                            <div class="home-card" onclick="window.showTab('tab-escala', document.querySelector('[onclick*=\'tab-escala\']'))">
                                <div class="icon-container"><i class="fas fa-calendar-days"></i></div>
                                <h3>Escala Mensal</h3>
                                <p>Gest√£o de equipe</p>
                            </div>
                        </div>
                    </div>

                    <div class="home-sector-section sector-group" data-sector="juridico">
                        <h3 class="home-sector-title" style="color: #6A1B9A;">Jur√≠dico</h3>
                        <div class="home-cards-grid">
                            <div class="home-card" onclick="window.showTab('tab-juridico-novo', document.querySelector('[onclick*=\'tab-juridico-novo\']'))">
                                <div class="icon-container"><i class="fas fa-scale-balanced"></i></div>
                                <h3>Novo Agendamento</h3>
                                <p>Agendar envio de link, chamar aluno...</p>
                            </div>

                            <div class="home-card" onclick="window.showTab('tab-juridico-calendario', document.querySelector('[onclick*=\'tab-juridico-calendario\']'))">
                                <div class="icon-container"><i class="fas fa-calendar-plus"></i></div>
                                <h3>Calend√°rio</h3>
                                <p>Panorama geral de agendamentos</p>
                            </div>

                            <div class="home-card" onclick="document.getElementById('btn-hist-juridico').click()">
                                <div class="icon-container"><i class="fas fa-box-archive"></i></div>
                                <h3>Hist√≥rico Jur√≠dico</h3>
                                <p>Consultar agendamentos</p>
                            </div>

                            <div class="home-card" onclick="window.showTab('tab-juridico-ligacoes', document.getElementById('btn-juridico-ligacoes'))">
                                <div class="icon-container"><i class="fas fa-headset"></i></div>
                                <h3>Liga√ß√µes Jur√≠dica</h3>
                                <p>Gest√£o de liga√ß√µes</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-usuarios" class="tab-content hidden">
                <div class="page-header-standard">
                    <h1 class="page-title-blue">GERENCIAMENTO DE EQUIPE</h1>
                    <div class="header-line"></div>
                </div>

                <div class="action-bar-right">
                    <button class="btn-primary-medcof" onclick="openUserModal()">
                        <i class="fas fa-plus"></i> NOVO USU√ÅRIO
                    </button>
                </div>

                <div class="table-container-light">
                    <table class="medcof-table">
                        <thead>
                            <tr>
                                <th>PERFIL</th>
                                <th>NOME COMPLETO</th>
                                <th>E-MAIL</th>
                                <th>CARGO</th>
                                <th>A√á√ïES</th>
                            </tr>
                        </thead>
                        <tbody id="user-table-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="user-modal" class="drawer-panel-light hidden">
                <div class="drawer-content">
                    <div class="drawer-header">
                        <h3 id="user-modal-title">EDITAR USU√ÅRIO</h3>
                        <button onclick="closeUserModal()" class="btn-close-drawer">&times;</button>
                    </div>

                    <div class="drawer-tabs-light">
                        <button class="drawer-tab-link active" onclick="switchUserTab('dados')">DADOS PESSOAIS</button>
                        <button class="drawer-tab-link" onclick="switchUserTab('permissoes')">ACESSO</button>
                    </div>

                    <form id="user-form">
                        <div id="user-tab-dados" class="drawer-pane">
                            <div class="form-group-light">
                                <label>NOME COMPLETO</label>
                                <input type="text" id="user-nome" placeholder="Digite o nome completo" required>
                            </div>
                            <div class="form-group-light">
                                <label>E-MAIL CORPORATIVO</label>
                                <input type="email" id="user-email" placeholder="exemplo@medcof.com.br" required>
                            </div>
                            
                            <div class="status-flex-row-light">
                                <span>USU√ÅRIO ATIVO</span>
                                <label class="medcof-switch-light">
                                    <input type="checkbox" id="user-status-active">
                                    <span class="medcof-slider round"></span>
                                </label>
                            </div>
                        </div>

                        <div id="user-tab-permissoes" class="drawer-pane hidden">
                            <div class="role-selection-light">
                                <p class="section-hint">Defina o n√≠vel de poder do usu√°rio no sistema:</p>
                                <label class="radio-card">
                                    <input type="radio" name="user-role" value="admin">
                                    <div class="radio-info">
                                        <strong>Administrador</strong>
                                        <span>Acesso total e gerenciamento de equipe.</span>
                                    </div>
                                </label>
                                <label class="radio-card">
                                    <input type="radio" name="user-role" value="normal" checked>
                                    <div class="radio-info">
                                        <strong>Usu√°rio Comum</strong>
                                        <span>Acesso restrito aos setores designados.</span>
                                    </div>
                                </label>
                            </div>
                        </div>

                        <div class="drawer-footer-light">
                            <button type="button" onclick="closeUserModal()" class="btn-cancel-light">CANCELAR</button>
                            <button type="submit" class="btn-save-light">SALVAR ALTERA√á√ïES</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="tab-dashboard" class="tab-content hidden">
               <div class="dashboard-header-row">
                    <h1>DASHBOARD GERENCIAL</h1>
                    
                    <div class="dash-controls-wrapper">
                        <div class="date-filter-group">
                            <span>üìÖ Filtro (Se√ß√µes Espec√≠ficas):</span>
                            <input type="text" id="dash-date-start" placeholder="In√≠cio" autocomplete="off">
                            <span>At√©</span>
                            <input type="text" id="dash-date-end" placeholder="Fim" autocomplete="off">
                            <button onclick="window.applyDashboardFilters()">Filtrar</button>
                            <button onclick="window.clearDashboardFilters()">Limpar</button>
                        </div>

                        <div class="dash-actions">
                            <button class="action-btn admin-only" onclick="window.openImportBiModal()" style="background:#6f42c1; color:white; border:none;">
                                üì• Importar Hist√≥rico
                            </button>
                            <span class="live-badge">‚óè Ao Vivo</span>
                        </div>
                    </div>
                </div>

                <h2 class="section-title">üåç Panorama Geral de Cobran√ßa</h2>

                <div class="kpi-grid-powerbi">
                    <div class="kpi-pbi-card"><div class="kpi-label">üí≤ D√©bito Total</div><div class="kpi-value" id="kpi-debito-total">R$ 0,00</div></div>
                    <div class="kpi-pbi-card"><div class="kpi-label">‚úÖ Pagamento Total</div><div class="kpi-value" id="kpi-pagamento-total">R$ 0,00</div></div>
                    <div class="kpi-pbi-card"><div class="kpi-label">üìâ % Convers√£o</div><div class="kpi-value" id="kpi-conversao">0%</div></div>
                    <div class="kpi-pbi-card"><div class="kpi-label">üì® Disparos</div><div class="kpi-value" id="kpi-disparos">0</div></div>
                </div>

                <div class="charts-grid-row">
                    <div class="chart-box big-chart">
                        <h3>üìä Status da Carteira (Por Etapa)</h3>
                        <div id="chart-bar-status"></div>
                    </div>
                    <div class="chart-box small-chart">
                        <h3>üéØ Meta Geral</h3>
                        <div id="chart-gauge-meta"></div>
                        <p class="meta-text" id="meta-text-display">-</p>
                    </div>
                </div>

                <div class="charts-grid-row">
                    <div class="chart-box big-chart">
                        <h3>üí≤ Comparativo MoM (% Recupera√ß√£o)</h3>
                        <div id="chart-line-mom"></div>
                    </div>
                    <div class="chart-box small-chart">
                        <h3>üí≥ Formas de Pagamento (Geral)</h3>
                        <div id="chart-pie-payment"></div>
                    </div>
                </div>

                <div class="chart-box full-width-chart" style="margin-top: 30px; margin-bottom: 40px;">
                    <h3>üìà Evolu√ß√£o de D√©bitos x Pagamentos (Hist√≥rico Completo)</h3>
                    <div id="chart-bar-evolution"></div>
                </div>

                <h2 class="section-title" style="border-left-color: #d35400; color: #4b4b4b;">üìû 3¬™ Cobran√ßa</h2>

                <div class="kpi-grid-powerbi">
                    <div class="kpi-pbi-card" style="border-left-color: #d35400;"><div class="kpi-label">üí≤ D√©bitos (3¬™ Cob)</div><div class="kpi-value" id="kpi-3cob-debito">R$ 0,00</div></div>
                    <div class="kpi-pbi-card" style="border-left-color: #e67e22;"><div class="kpi-label">‚úÖ Pagos (3¬™ Cob)</div><div class="kpi-value" id="kpi-3cob-pago">R$ 0,00</div></div>
                    <div class="kpi-pbi-card" style="border-left-color: #f39c12;"><div class="kpi-label">üìâ % Conv. (3¬™ Cob)</div><div class="kpi-value" id="kpi-3cob-conv">0%</div></div>
                    <div class="kpi-pbi-card" style="border-left-color: #34495e;"><div class="kpi-label">üì® Disparos (3¬™ Cob)</div><div class="kpi-value" id="kpi-3cob-disparos">0</div></div>
                </div>

                <div class="charts-grid-row">
                    <div class="chart-box big-chart">
                        <h3>üìà Evolu√ß√£o da Taxa de Convers√£o (3¬™ Cob)</h3>
                        <div id="chart-3cob-evolution-line"></div>
                    </div>
                    <div class="chart-box small-chart">
                        <h3>‚öñÔ∏è D√©bitos x Pagamentos</h3>
                        <div id="chart-3cob-pie"></div>
                    </div>
                </div>
            </div>

            <div id="tab-dash-juridico" class="tab-content hidden" style="width: 100%; padding: 20px; box-sizing: border-box;">
    
                <div class="dashboard-header" style="background: linear-gradient(135deg, #0d47a1, #1565c0); padding: 20px; border-radius: 10px; color: white; margin-bottom: 25px; box-shadow: 0 4px 10px rgba(0,0,0,0.1);">
                    <div style="display:flex; justify-content:center ; align-items:center; flex-wrap:wrap; gap:15px;">
                        <div>
                            <h2 style="margin:0; font-size:24px; font-weight: 700;">Dashboard Jur√≠dico</h2>
                            <p style="margin:0; opacity:0.9; font-size: 14px;">Indicadores de Performance e Recupera√ß√£o</p>
                        </div>
                        <div style="display:flex; gap:10px; align-items:center; background: rgba(255,255,255,0.1); padding: 5px 15px; border-radius: 8px;">
                            <input type="date" id="dash-jur-start" class="date-filter" style="border:none; padding:8px; border-radius:5px; color:#333;">
                            <span style="font-weight:bold; font-size: 13px;">at√©</span>
                            <input type="date" id="dash-jur-end" class="date-filter" style="border:none; padding:8px; border-radius:5px; color:#333;">
                            <button onclick="window.loadJuridicoDashboard()" style="background:white; color:#0d47a1; border:none; padding:8px 20px; border-radius:5px; cursor:pointer; font-weight:bold; transition: transform 0.2s;">Filtrar</button>
                            <button onclick="window.openImportDashJuridico()" style="background:#ffca28; color:#333; border:none; padding:8px 20px; border-radius:5px; cursor:pointer; font-weight:bold; margin-left:10px;">üì• Importar</button>
                        </div>
                    </div>
                </div>

                <div id="juridico-kpi-container" style="display: grid; grid-template-columns: repeat(6, 1fr); gap: 15px; margin-bottom: 30px; width: 100%;">
                </div>

                <div class="charts-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 25px; width: 100%;">
    
                    <div class="chart-card" style="background:white; padding:20px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; min-width: 0;">
                        <h3 style="color:#0d47a1; margin-bottom:15px; font-weight:700; font-size: 16px;">Retorno dos Disparos (Volume)</h3>
                        <div class="chart-canvas-wrapper" style="position: relative; height: 340px; width: 100%;">
                            <canvas id="chart-jur-funil"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" style="background:white; padding:20px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; min-width: 0;">
                        <h3 style="color:#0d47a1; margin-bottom:15px; font-weight:700; font-size: 16px;">Comparativo de Recupera√ß√£o (M√™s Anterior)</h3>
                        <div class="chart-canvas-wrapper" style="position: relative; height: 340px; width: 100%;">
                            <canvas id="chart-jur-recuperacao"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" style="background:white; padding:20px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; min-width: 0;">
                        <h3 style="color:#0d47a1; margin-bottom:15px; font-weight:700; font-size: 16px;">Hist√≥rico de Disparos (√öltimos 12 meses)</h3>
                        <div class="chart-canvas-wrapper" style="position: relative; height: 340px; width: 100%;">
                            <canvas id="chart-jur-historico"></canvas>
                        </div>
                    </div>

                    <div class="chart-card" style="background:white; padding:20px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.05); border: 1px solid #e0e0e0; min-width: 0;">
                        <h3 style="color:#0d47a1; margin-bottom:15px; font-weight:700; font-size: 16px;">Comparativo Anual (Disparos, D√©bitos, Pagos)</h3>
                        <div class="chart-canvas-wrapper" style="position: relative; height: 340px; width: 100%;">
                            <canvas id="chart-jur-anual"></canvas>
                        </div>
                    </div>

                </div>
            </div>

            <div id="tab-agendamento" class="tab-content hidden">
                <h1>AGENDAMENTO DE LINK</h1>
                <div class="form-container">
                    <form id="link-schedule-form" class="professional-form">
                        <input name="Nome" type="text" placeholder="Nome Completo do Aluno" required autocomplete="off">
                        <input name="Email" type="email" placeholder="E-mail do Aluno" required autocomplete="off">
                        <input name="Curso" type="text" placeholder="Nome do Curso" required autocomplete="off">
                        <input name="Telefone" type="tel" placeholder="Telefone com DDD" required autocomplete="off">
                        
                        <label>Motivo do Link:</label>
                        <select name="Motivo" required>
                            <option value="" disabled selected>Selecione o motivo</option>
                            <option value="Link de pagamento Mercury">Link de pagamento Mercury</option>
                            <option value="Renegocia√ß√£o Mercury">Renegocia√ß√£o Mercury</option>
                            <option value="Link de pagamento GURU">Link de pagamento GURU</option>
                            <option value="Cancelamento">Cancelamento</option>
                            <option value="Parcelas vencidas somadas">Parcelas vencidas somadas</option>
                        </select>
                        
                        <div style="display: flex; gap: 10px;">
                            <input name="QtdParcelas" type="number" placeholder="Qtd. Parcelas" min="1" required autocomplete="off">
                            <input name="ValorParcela" type="text" placeholder="Valor Parcela (R$)" required autocomplete="off">
                        </div>
                        
                        <label>Data de Vencimento:</label>
                        <input name="DataVencimento" id="datepicker-vencimento" type="text" placeholder="Selecione a data" required autocomplete="off">
                        
                        <label>Data para Gerar Link:</label>
                        <input name="DataGerarLink" id="datepicker-gerar" type="text" placeholder="Selecione a data" required autocomplete="off">
                        
                        <label>Observa√ß√£o:</label>
                        <textarea name="Observacao" placeholder="Detalhes adicionais..." rows="3"></textarea>
                            
                        <button type="submit">SALVAR AGENDAMENTO</button>
                        <p id="form-message"></p>
                    </form>
                </div>
            </div>

            <div id="tab-calendario" class="tab-content hidden">
                <h1>CALEND√ÅRIO COBRAN√áA</h1>
                <div class="calendar-controls-wrapper">
                    <button class="cobranca-btn-small" onclick="window.changeMonth(-1, 'cobranca')">&lt; Anterior</button>
                    <span id="currentMonthDisplay" class="currentMonthDisplay"></span> 
                    <button class="cobranca-btn-small" onclick="window.changeMonth(1, 'cobranca')">Pr√≥ximo &gt;</button>
                </div>
                <div id="calendar-view"></div>
            </div>

            <div id="tab-lista-cobranca" class="tab-content hidden">
                <h1>HIST√ìRICO DE AGENDAMENTOS</h1>
                <div class="filters-container">
                    <div class="search-box">
                        <input type="text" id="search-cobranca" placeholder="üîç Buscar aluno, curso..." onkeyup="window.filterCobrancaHistory()">
                    </div>
                    <div class="date-filters">
                        <input type="text" id="filter-start-cobranca" placeholder="Data Inicial" autocomplete="off">
                        <input type="text" id="filter-end-cobranca" placeholder="Data Final" autocomplete="off">
                    </div>
                    <button class="clean-filter-btn" onclick="window.clearCobrancaFilters()">Limpar</button>
                </div>
                <div class="table-wrapper">
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th class="sortable" onclick="window.sortCobranca('DataGerarLink')">Gerar Link ‚ñº</th>
                                <th class="sortable" onclick="window.sortCobranca('Nome')">Aluno ‚Üï</th>
                                <th class="sortable" onclick="window.sortCobranca('Curso')">Curso ‚Üï</th>
                                <th class="sortable" onclick="window.sortCobranca('ValorParcela')">Valor ‚Üï</th>
                                <th class="sortable" onclick="window.sortCobranca('DataVencimento')">Vencimento ‚Üï</th>
                                <th style="text-align: center;">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="table-body-cobranca"></tbody>
                    </table>
                    <p id="no-results-cobranca" style="display: none; text-align: center; margin-top: 20px; color: #666;">Nenhum agendamento encontrado.</p>
                </div>
            </div>

            <div id="tab-cobranca" class="tab-content hidden">
                <h1>CONTROLE 3¬™ COBRAN√áA</h1>
                <div class="filters-container">
                    <div class="kpi-box"><span id="total-active-count">0</span><small>Ativos</small></div>
                    <div class="search-box">
                        <input type="text" id="cobranca-search" placeholder="üîç Buscar aluno..." onkeyup="window.filterCobranca()">
                    </div>
                    <button class="import-btn admin-only" onclick="window.openImportModal()">üì• Imp.</button>
                    <button class="action-btn secondary admin-only" onclick="window.exportActiveCobranca()" >üì§ Lig.</button>
                    <button class="action-btn secondary admin-only" onclick="window.exportNoAnswerStudents()" >üìµ Temp.</button>
                    <button class="action-btn admin-only" onclick="window.openPaymentsModal()" style="background-color: #198754; color: white; border-color: #198754; margin-right: 10px;">üí≤ Pags.</button>
                </div>
                <div id="cobranca-list" class="cards-container"></div>
            </div>

            <!-- ABA: JUR√çDICO ‚Äî NOVO AGENDAMENTO -->
            <div id="tab-juridico-novo" class="tab-content hidden">
                <h1 class="juridico-title">JUR√çDICO ‚Äì NOVO AGENDAMENTO</h1>

                <div class="form-container juridico-border">
                    <form id="juridico-form" class="professional-form">
                        
                        <input name="Nome" type="text" placeholder="Nome do Aluno*" required autocomplete="off">
                        <input name="Email" type="email" placeholder="E-mail*" required autocomplete="off">
                        <input name="Telefone" type="tel" placeholder="Telefone" autocomplete="off">

                        <label>Data para A√ß√£o:</label>
                        <input name="DataAcao" id="datepicker-juridico" type="text" placeholder="Selecione a data*" required autocomplete="off">

                        <label>A√ß√£o:</label>
                        <select name="A√ß√£o" required>
                            <option value="" disabled selected>Selecione o motivo*</option>
                            <option value="Link de pagamento Mercury">Link de pagamento Mercury</option>
                            <option value="Renegocia√ß√£o Mercury">Renegocia√ß√£o Mercury</option>
                            <option value="Link de pagamento GURU">Link de pagamento GURU</option>
                            <option value="Renegocia√ß√£o GURU">Renegocia√ß√£o GURU</option>
                            <option value="Cancelamento">Cancelamento</option>
                            <option value="Olhar se pagou">Olhar se pagou</option>
                            <option value="Chamar no chat">Chamar no chat</option>
                        </select>
                        
                        <div style="display: flex; gap: 10px;">
                            <input name="QtdParcelas" type="number" placeholder="Qtd. Parcelas" min="1" autocomplete="off">
                            <input name="ValorParcela" type="text" placeholder="Valor Parcela (R$)" autocomplete="off">
                        </div>

                        <label>Observa√ß√µes:</label>
                        <textarea 
                            name="Observacao"
                            placeholder="Detalhes do processo..."
                            rows="4"
                        ></textarea>

                        <button type="submit" class="juridico-btn">SALVAR AGENDAMENTO</button>

                        <p id="juridico-message"
                            style="text-align:center; margin-top:12px; font-weight:bold;">
                        </p>
                    </form>
                </div>
            </div>

            <!-- ABA: JUR√çDICO ‚Äì CALEND√ÅRIO -->
            <div id="tab-juridico-calendario" class="tab-content hidden">
                <h1 class="juridico-title">CALEND√ÅRIO JUR√çDICO</h1>

                <div class="calendar-controls-wrapper">
                    <button class="juridico-btn-small" onclick="window.changeJuridicoMonth(-1)">&lt; Anterior</button>
                    <span id="juridicoMonthDisplay" class="juridico-month-label"></span>
                    <button class="juridico-btn-small" onclick="window.changeJuridicoMonth(1)">Pr√≥ximo &gt;</button>
                </div>

                <div id="juridico-calendar-view"></div>
            </div>

            <div id="tab-lista-juridico" class="tab-content hidden">
                <h1 class="juridico-title">HIST√ìRICO JUR√çDICO</h1> <div class="filters-container juridico-border"> <div class="search-box">
                        <input type="text" id="search-juridico" placeholder="üîç Buscar nome, e-mail, a√ß√£o..." onkeyup="window.filterJuridicoHistory()">
                    </div>
                    <div class="date-filters">
                        <input type="text" id="filter-start-juridico" placeholder="Data Inicial" autocomplete="off">
                        <input type="text" id="filter-end-juridico" placeholder="Data Final" autocomplete="off">
                    </div>
                    <button class="clean-filter-btn" onclick="window.clearJuridicoFilters()">Limpar</button>
                </div>
                <div class="table-wrapper">
                    <table class="styled-table">
                        <thead>
                            <tr style="background-color: #6A1B9A;"> <th>Data A√ß√£o</th>
                                <th>Nome</th>
                                <th>E-mail</th>
                                <th>A√ß√£o Necess√°ria</th>
                                <th>Criado Em</th>
                                <th style="text-align: center;">Detalhes</th>
                            </tr>
                        </thead>
                        <tbody id="table-body-juridico"></tbody>
                    </table>
                    <p id="no-results-juridico" style="display: none; text-align: center; margin-top: 20px; color: #666;">Nenhum processo encontrado.</p>
                </div>
            </div>

            <!-- ============================
                JUR√çDICO ‚Äî LIGA√á√ïES (ABAS)
            ============================= -->
            <div id="tab-juridico-ligacoes" class="tab-content hidden">
            <h1 class="juridico-title">LIGA√á√ïES ‚Äî JUR√çDICO</h1>

            <div class="filters-container">
                <div class="kpi-box">
                <span id="total-juridico-count">0</span>
                <small>Ativos</small>
                </div>

                <div class="search-box">
                <input type="text" id="juridico-ligacoes-search" placeholder="üîç Buscar..." onkeyup="window.filterJuridicoList()">
                </div>

                <button class="import-btn admin-only" onclick="window.openImportModalJuridico()">üì• Importar</button>
                <button onclick="window.exportJuridicoNoInteraction()" class="btn-export" style="background-color: #198754; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">üìä Exportar</button>
            </div>

            <div id="juridico-ligacoes-list" class="cards-container"></div>
            </div>

            <!-- IMPORTAR JUR√çDICO (modal espec√≠fico) -->
            <div id="import-modal-juridico" class="modal-hidden">
            <div id="import-modal-box">
                <h2>Importar Liga√ß√µes Jur√≠dicas</h2>
                <p class="instruction">
                Cole do Excel/Sheets sem cabe√ßalho.<br>
                <strong>Ordem:</strong> Curso | Nome | Email | CPF | Telefone | ValorParcela | TotalAberto | Vencimento | Data1Jur
                </p>

                <textarea id="import-data-juridico" placeholder="Cole os dados aqui..."></textarea>

                <div class="modal-actions">
                <button class="cancel-btn" onclick="window.closeImportModalJuridico()">Cancelar</button>
                <button class="confirm-btn" onclick="window.processImportJuridico()">Processar</button>
                </div>
            </div>
            </div>

            <!-- MODAL EXCLUSIVO: A√á√ïES JUR√çDICO -->
            <div id="actions-modal-juridico" class="modal-hidden">
            <div id="actions-modal-juridico-box">
                <div class="actions-header-juridico">
                <h2 id="juridico-actions-student-name">Nome / Processo</h2>
                <button class="close-btn" onclick="window.closeActionsModalJuridico()">‚úñ</button>
                </div>

                <div class="actions-body-juridico">
                <div class="actions-col-main-juridico">
                    <div id="juridico-actions-student-details" class="details-panel"></div>

                    <label for="juridico-extra-status-select"><strong>Status Extra:</strong></label>
                    <select id="juridico-extra-status-select" onchange="window.saveExtraStatusJuridico()">
                    <option value="">Nenhum</option>
                    <option value="link_enviado">Link enviado</option>
                    <option value="link_agendado">Link agendado</option>
                    <option value="em_negociacao">Em negocia√ß√£o</option>
                    </select>

                    <div class="sequence-panel-juridico">
                        <div style="display: flex; gap: 10px; width: 100%; margin-bottom: 10px;">
                            <button id="juridico-btn-atendeu" class="action-step-btn-large" style="background-color: #28a745; color: white;" onclick="window.AtendimentoJuridico()">
                                üìû ATENDEU
                            </button>
                            
                            <button id="juridico-btn-next-template" class="action-step-btn-large" style="background-color: #007bff; color: white;" onclick="window.VerificadoJuridico()">
                                ‚úÖ VERIFICADO
                            </button>
                        </div>
                        
                        <button id="juridico-btn-next-call" class="action-step-btn-large" style="width: 100%; margin-bottom: 10px;" onclick="window.nextCallStageJuridico()">
                            ‚è≥ TENTATIVA DE LIGA√á√ÉO
                        </button>
                        
                        <p id="juridico-last-action-info" class="info-text" style="font-size: 12px; color: #666;"></p>
                    </div>

                    <div class="payment-panel-juridico">
                        <h3>Registrar Pagamento</h3>
                        
                        <div id="juridico-course-selection" style="margin-bottom: 15px; background: #f8fafc; padding: 12px; border-radius: 8px; border: 1px solid #e2e8f0;">
                            <p style="font-size: 11px; font-weight: bold; margin-bottom: 10px; color: #6A1B9A; text-transform: uppercase;">Selecione o(s) curso(s) pago(s):</p>
                            
                            <div id="juridico-course-checkbox-list" class="pill-checkbox-group">
                                </div>
                        </div>

                        <div class="payment-controls">
                            <input type="date" id="juridico-payment-date">
                            <select id="juridico-payment-origin">
                                <option value="" disabled selected>Origem</option>
                                <option value="Pagamento normal">Pagamento normal</option>
                                <option value="Atendimento">Atendimento</option>
                                <option value="Liga√ß√£o">Liga√ß√£o</option>
                                <option value="Supervis√£o">Supervis√£o</option>
                            </select>
                            <button class="save-payment-btn" style="background-color: #6A1B9A;" onclick="window.registerPaymentJuridico()">Baixar</button>
                        </div>
                    </div>

                </div>

                <div class="actions-col-proposals-juridico">
                    <h3>Propostas / Notas</h3>
                    <div class="proposal-item"><label>Proposta 1:</label><textarea id="jur-prop-1" onblur="window.saveProposalJuridico(1)"></textarea></div>
                    <div class="proposal-item"><label>Proposta 2:</label><textarea id="jur-prop-2" onblur="window.saveProposalJuridico(2)"></textarea></div>
                    <div class="proposal-item"><label>Proposta 3:</label><textarea id="jur-prop-3" onblur="window.saveProposalJuridico(3)"></textarea></div>
                    <div class="proposal-item"><label>Observa√ß√µes:</label><textarea id="jur-prop-4" onblur="window.saveProposalJuridico(4)"></textarea></div>
                </div>
                </div>
            </div>
            </div>

            <div id="tab-escala" class="tab-content hidden">
                <div class="page-header-standard">
                    <h1 class="page-title-blue">ESCALA MENSAL DE COBRAN√áA</h1>
                    <div class="header-line"></div>
                </div>

                <div class="escala-navigation-card">
                    <button class="nav-month-btn" onclick="window.changeEscalaMonth(-1)">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="month-info">
                        <i class="fas fa-calendar-alt"></i>
                        <span id="escala-month-label" class="month-display">Carregando...</span>
                    </div>
                    <button class="nav-month-btn" onclick="window.changeEscalaMonth(1)">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>

                <div class="action-bar-center">
                    <button id="btn-open-editor" class="btn-primary-medcof admin-only" onclick="window.openEscalaEditor()">
                        <i class="fas fa-edit"></i> EDITAR ESCALA
                    </button>
                </div>

                <div id="escala-editor-wrapper" class="escala-drawer hidden">
                    <div class="drawer-header-escala">
                        <div class="header-left-group">
                            <button onclick="window.closeEscalaEditor()" class="btn-exit-editor">
                                <i class="fas fa-arrow-left"></i> Voltar
                            </button>
                            <button onclick="window.toggleEscalaSidebar()" class="btn-toggle-sidebar" title="Recolher Equipe">
                                <i class="fas fa-users-slash" id="sidebar-toggle-icon"></i>
                            </button>
                        </div>
                        <div class="editor-quick-tools">
                            <button onclick="window.openSpecialShiftConfigurator()" class="btn-action-secondary" style="background-color: #e67e22; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; font-weight: bold;"><i class="fas fa-clock"></i> Hor√°rio Especial</button>
                            <button onclick="window.openFolgaConfigurator()" class="btn-tool-modern folga"><i class="fas fa-umbrella-beach"></i> Folga</button>
                            <button onclick="window.openHolidayConfigurator()" class="btn-tool-modern feriado"><i class="fas fa-star"></i> Feriados</button>
                            <button onclick="window.menuFerias()" class="btn-tool-modern ferias"><i class="fas fa-plane"></i> F√©rias</button>
                            <button onclick="window.openCycleConfigurator()" class="btn-tool-modern config"><i class="fas fa-sync"></i> Ciclos</button>
                            <button onclick="window.autoFillCycle()" class="btn-tool-modern magic"><i class="fas fa-wand-magic-sparkles"></i> Auto Ciclo</button>
                        </div>
                    </div>

                    <div class="escala-editor-layout">
                        <aside id="escala-sidebar-staff" class="escala-sidebar">
                            <div class="staff-card">
                                <h3>EQUIPE</h3>
                                <div id="employees-list" class="staff-list-scroll"></div>
                            </div>
                        </aside>
                        <main class="escala-main-content">
                            <div id="escala-message"></div>
                            <div id="escala-container"></div> 
                        </main>
                    </div>
                </div>

                <div id="escala-view-container">
                    <div id="escala-view-content"></div> 
                </div>
            </div>

            <div id="tab-disparos-registros" class="tab-content hidden">
                <div class="page-header-standard">
                    <h1 class="page-title-blue">REGISTROS DE DISPAROS</h1>
                    <div class="header-line"></div>
                </div>

                <div class="entry-card-container">
                    <div class="entry-card-header">
                        <span><i class="fas fa-keyboard"></i> NOVO LAN√áAMENTO R√ÅPIDO</span>
                    </div>
                    <div class="entry-card-body">
                        <div class="input-cell">
                            <label><i class="fas fa-calendar-day"></i> DATA</label>
                            <input type="text" id="quick-disparo-data" placeholder="00/00/0000">
                        </div>
                        
                        <div class="input-cell">
                            <label><i class="fas fa-tag"></i> DESCRI√á√ÉO DO DISPARO</label>
                            <select id="quick-disparo-tipo">
                                <option value="" disabled selected>Selecione o tipo...</option>
                                <optgroup label="Active">
                                <option value="Active - Lembrete Dia do vencimento">Active - Lembrete Dia do vencimento</option>
                                <option value="Active - 1¬™ Cobran√ßa">Active - 1¬™ Cobran√ßa</option>
                                <option value="Active - Lembrete 7 Dias">Active - Lembrete 7 Dias</option>
                                <option value="Active - 2¬™ Cobran√ßa">Active - 2¬™ Cobran√ßa</option>
                                <option value="Active - 3¬™ Cobran√ßa">Active - 3¬™ Cobran√ßa</option>
                            </optgroup>
                            <optgroup label="Infobip [GURU]">
                                <option value="[GURU] - Lembrete Dia do vencimento">[GURU] - Lembrete Dia do vencimento</option>
                                <option value="[GURU] - 1¬™ Cobran√ßa">[GURU] - 1¬™ Cobran√ßa</option>
                                <option value="[GURU] - Lembrete 7 Dias">[GURU] - Lembrete 7 Dias</option>
                                <option value="[GURU] - 2¬™ Cobran√ßa">[GURU] - 2¬™ Cobran√ßa</option>
                                <option value="[GURU] - 3¬™ Cobran√ßa">[GURU] - 3¬™ Cobran√ßa</option>
                            </optgroup>
                            <optgroup label="Juridica">
                                <option value="1¬™ Cobran√ßa Jur√≠dica">1¬™ Cobran√ßa Jur√≠dica</option>
                                <option value="2¬™ Cobran√ßa Jur√≠dica">2¬™ Cobran√ßa Jur√≠dica</option>
                            </optgroup>
                            <optgroup label="Bloqueios/Desbloqueios">
                                <option value="Bloqueio 2¬∞ Cobran√ßa">Bloqueio 2¬∞ Cobran√ßa</option>
                                <option value="Desbloqueio entre 2¬∞ e 3¬∞ Cobran√ßa">Desbloqueio entre 2¬∞ e 3¬∞ Cobran√ßa</option>
                                <option value="Desbloqueio 3¬∞ Cobran√ßa">Desbloqueio 3¬∞ Cobran√ßa</option>
                            </optgroup>
                            </select>
                        </div>
                        <div class="input-cell" style="max-width: 120px;">
                            <label><i class="fas fa-layer-group"></i> QTD</label>
                            <input type="number" id="quick-disparo-qtd" placeholder="0">
                        </div>

                        <div class="input-cell">
                            <label><i class="fas fa-dollar-sign"></i> VALOR TOTAL</label>
                            <input type="text" id="quick-disparo-valor" placeholder="0,00">
                        </div>

                        <div class="input-cell-btn">
                            <button onclick="window.saveQuickDisparo()" class="btn-add-record">
                                <i class="fas fa-plus"></i> ADICIONAR
                            </button>
                        </div>
                    </div>
                </div>

                <div class="calendar-dashboard-container">
                    <div class="calendar-header">
                        <button onclick="changeMonth(-1)" class="btn-nav"><i class="fas fa-chevron-left"></i></button>
                        <h2 id="current-month-display">Janeiro 2026</h2>
                        <button onclick="changeMonth(1)" class="btn-nav"><i class="fas fa-chevron-right"></i></button>
                    </div>
                    
                    <div class="calendar-grid-header">
                        <div>Dom</div><div>Seg</div><div>Ter</div><div>Qua</div><div>Qui</div><div>Sex</div><div>S√°b</div>
                    </div>
                    <div id="calendar-body" class="calendar-grid-body">
                        </div>
                </div>
            </div>

            <div id="modal-dia-disparos" class="modal-overlay hidden">
                <div class="modal-card-wide">
                    <div class="modal-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 id="modal-date-title" style="margin: 0; color: #1e293b;">Registros</h3>
                        <button onclick="closeDisparoModal()" class="close-btn" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                    </div>
                    <div class="modal-body" style="max-height: 400px; overflow-y: auto;">
                        <table class="medcof-table">
                            <thead>
                                <tr>
                                    <th style="text-align:left;">DESCRI√á√ÉO</th>
                                    <th>RESPONS√ÅVEL</th>
                                    <th>QTD</th>
                                    <th>VALOR</th>
                                    <th>A√á√ïES</th>
                                </tr>
                            </thead>
                            <tbody id="modal-table-body">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-overlay" class="modal-hidden">
        <div id="modal-box">
            <h2 id="modal-title">Aviso</h2>
            <p id="modal-message"></p>
            <button id="modal-close-btn" onclick="window.closeCustomAlert()">Fechar</button>
        </div>
    </div>

    <div id="details-modal-overlay" class="modal-hidden">
        <div id="details-modal-box">
            <div id="details-modal-header">
                <h2 id="details-modal-title">Detalhes</h2>
                <button id="copy-details-btn" onclick="window.copyAppointmentFormatted()">Copiar</button>
            </div>
            <div id="details-modal-content"></div>
            <button id="details-modal-close-btn" onclick="window.closeDetailsModal()">Fechar</button>
        </div>
    </div>
    
    <div id="actions-modal-overlay" class="modal-hidden">
        <div id="actions-modal-box">
            <div class="actions-header">
                <h2 id="actions-student-name">Nome do Aluno</h2>
                <button class="close-btn" onclick="window.closeActionsModal()">‚úñ</button>
            </div>
            <div class="actions-body">
                <div class="actions-col-main">
                    <div id="actions-student-details" class="details-panel"></div>
                    <label><strong>Status Extra:</strong></label>
                    <select id="extra-status-select" class="swal2-input" onchange="window.saveExtraStatus()">
                        <option value="">-- Remover Status --</option>
                        <option value="Link enviado">Link enviado</option>
                        <option value="Link agendado">Link Agendado</option>
                        <option value="Em negocia√ß√£o">Em negocia√ß√£o</option>
                        <option value="Jur√≠dica">Jur√≠dica</option>
                    </select>
                    <div class="sequence-panel">
                        <div style="display: flex; gap: 10px; width: 100%;">
                            <button id="btn-next-call" class="action-step-btn-large seq-call" onclick="window.Liga√ß√£oAtendida()">
                                üìû ATENDEU
                            </button>
                            <button id="btn-next-template" class="action-step-btn-large seq-msg" onclick="window.Verifica√ß√£oFeita()">
                                ‚úÖ VERIFICADO
                            </button>
                        </div>
                        <p id="last-action-info" class="info-text" style="margin-top: 10px; font-size: 12px; color: #666;"></p>
                    </div>
                    <div class="payment-panel">
                        <h3>Registrar Pagamento</h3>
                        
                        <div id="payment-course-selection" style="margin-bottom: 15px; background: rgba(255,255,255,0.5); padding: 10px; border-radius: 6px; border: 1px solid #ffeeba;">
                            <p style="font-size: 12px; font-weight: bold; margin-bottom: 8px; color: #856404;">Selecione o(s) curso(s) pago(s):</p>
                            <div id="course-checkbox-list">
                                </div>
                        </div>

                        <div class="payment-controls">
                            <input type="date" id="payment-date">
                            <select id="payment-origin">
                                <option value="" disabled selected>Origem</option>
                                <option value="Pagamento normal">Pagamento normal</option>
                                <option value="Atendimento">Atendimento</option>
                                <option value="Liga√ß√£o">Liga√ß√£o</option>
                                <option value="Supervis√£o">Supervis√£o</option>
                            </select>
                            <button class="save-payment-btn" onclick="window.registerPayment()">Baixar</button>
                        </div>
                    </div>
                </div>
                <div class="actions-col-proposals">
                    <h3>Propostas</h3>
                    <div class="proposal-item"><label>Proposta 1:</label><textarea id="prop-1" onblur="window.saveProposal(1)"></textarea></div>
                    <div class="proposal-item"><label>Proposta 2:</label><textarea id="prop-2" onblur="window.saveProposal(2)"></textarea></div>
                    <div class="proposal-item"><label>Proposta 3:</label><textarea id="prop-3" onblur="window.saveProposal(3)"></textarea></div>
                    <div class="proposal-item"><label>Observa√ß√µes:</label><textarea id="prop-4" onblur="window.saveProposal(4)"></textarea></div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-import-dash-juridico" class="modal-overlay modal-hidden">
        <div class="modal-content" style="max-width: 500px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
            <h3 style="color:#0d47a1; margin-top:0;">Importar Dados (Dashboard Jur√≠dico)</h3>
            <p style="font-size:12px; color:#666; margin-bottom:10px;">
                Cole as colunas na ordem:<br>
                Data | Disparos | D√©bitos | Intera√ß√µes | Neg. Info | Acordos Info | Pagamentos | Neg. Email | Acordos Email | Cancel. | Rec. Perdida | Termos
            </p>
            <textarea id="import-dash-juridico-text" rows="10" placeholder="Cole os dados do Excel aqui..." style="width:100%; padding:10px; border:1px solid #ddd; border-radius:5px;"></textarea>
            <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:15px;">
                <button onclick="document.getElementById('modal-import-dash-juridico').classList.add('modal-hidden')" style="padding: 8px 15px; cursor: pointer; background: #ccc; border: none; border-radius: 5px;">Cancelar</button>
                <button onclick="window.processImportDashJuridico()" style="background:#0d47a1; color:white; border:none; padding:8px 20px; border-radius:5px; cursor: pointer;">Processar</button>
            </div>
        </div>
    </div>

    <div id="import-modal-overlay" class="modal-hidden">
        <div id="import-modal-box">
            <h2>Importar Alunos (3¬™ Cobran√ßa)</h2>
            <p class="instruction">Copie do Excel e cole abaixo (Sem cabe√ßalho).<br>
            <strong>Ordem:</strong> Nome | Email | CPF | Telefone | Curso | FormaPag | Valor | Vencimento | Data 3¬™ Cob | Data 1¬™ Jur</p>
            <textarea id="import-data" placeholder="Cole os dados aqui..."></textarea>
            <div class="modal-actions">
                <button class="cancel-btn" onclick="window.closeImportModal()">Cancelar</button>
                <button class="confirm-btn" onclick="window.processImport()">Processar</button>
            </div>
        </div>
    </div>

    <div id="payments-modal-overlay" class="modal-hidden">
        <div id="payments-modal-box">
            <div class="actions-header" style="background-color: #198754;">
                <h2 style="color:white; margin:0;">üí∞ Relat√≥rio de Pagamentos</h2>
                <button class="close-btn" onclick="window.closePaymentsModal()" style="color:white;">‚úñ</button>
            </div>
            
            <div class="payments-content" style="padding: 20px; overflow-y: auto; max-height: 80vh;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <div>
                        <p style="color:#666; margin:0 0 10px 0;">Lista de todos os alunos baixados como "Pago".</p>
                        <button class="action-btn" onclick="window.exportPaymentsExcel()" style="background-color:#198754; color:white; border:none; padding:8px 15px; border-radius:6px; font-weight:bold; cursor:pointer;">
                            üìä Exportar Excel
                        </button>
                    </div>

                    <div class="kpi-box" style="background:#198754;">
                        <span id="total-payments-count">0</span>
                        <small>Total Baixado</small>
                    </div>
                </div>

                <div class="table-wrapper">
                    <table class="styled-table">
                        <thead>
                            <tr style="background-color: #198754;">
                                <th>Data Baixa</th>
                                <th>Aluno</th>
                                <th>Valor</th>
                                <th>Origem</th>
                                <th>Baixado Por</th>
                            </tr>
                        </thead>
                        <tbody id="payments-table-body"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div id="import-bi-modal" class="modal-hidden">
    <div id="import-modal-box" style="max-width: 700px;">
        <h2 style="color: #6f42c1;">Importar Hist√≥rico (Planilha)</h2>
        <p class="instruction">
            Copie as colunas da sua planilha e cole abaixo.<br>
            <strong>Ordem esperada:</strong> Etapa | Data | Disparos | D√©bitos | Pagamento
        </p>
        <p style="font-size:12px; color:#666;">
            *Isso alimentar√° os gr√°ficos de Disparos, D√©bito Total e Comparativo.
        </p>
        
        <textarea id="import-bi-data" placeholder="Cole aqui (Ctrl+V)..." style="height: 200px;"></textarea>
        
        <div class="modal-actions">
            <button class="cancel-btn" onclick="document.getElementById('import-bi-modal').classList.add('modal-hidden')">Cancelar</button>
            <button class="confirm-btn" onclick="window.processImportBi()">Processar Dados</button>
        </div>
    </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>